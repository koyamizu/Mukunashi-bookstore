<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>注文画面</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
		crossorigin="anonymous"></script>
</head>

<body>
	<header>
		<h1>椋梨書店</h1>
	</header>

	<div class="container">

		<a th:href="@{/kadai/bookController}">戻る</a>
<!--		適切な属性名と要素をそれぞれ記入し、cart(Map)が空の場合と空ではない場合で表示内容を変更してください-->
		<div ？="">
			<p>カートに入っているものはありません</p>
		</div>
		<div ？="">
			<table class="table table-bordered">
				<thead>
					<tr>
						<th>書名</th>
						<th>価格</th>
						<th>冊数</th>
						<th>小計</th>
					</tr>
				</thead>
				<tbody>
<!--					繰り返しと参照のための属性名を書いてください-->
					<div ？="item:${cart}" ？="${item}">
						<tr>
<!--							内容を表示するための属性名を書いてください-->
							<td ？="*{key.title}"></td>
							<td ？="*{key.price}"></td>
							<td ？="*{value}"></td>
							<td ？="*{#aggregates.sum({key.price * value})}"></td>
						</tr>
					</div>
					<tr class="table-primary">
						<td><strong>合計</strong></td>
						<td></td>
						<td><strong th:text="${#aggregates.sum(cart.![value])}"></strong>
						</td>
						<td><strong th:text="${#aggregates.sum(cart.![key.price * value])}"></strong></td>
					</tr>
				</tbody>
			</table>

<!--			フォームデータを送信するために必要な属性名が2つ欠けているので記入してください-->
			<form ？="@{/kadai/bookController/order/execute}" th:object="${customerForm}" class="container"
				？>
				<p th:if="${#fields.hasErrors('*')}" th:each="err:${#fields.errors('*')}" th:text="${err}"
					class="text-danger">
					エラーメッセージ
				</p>
				<h3>お届け先</h3>
				<div class="row">
					<div class="col-sm">
						<label for="name" class="form-label">お名前</label>
						<input type="text" th:field="*{name}" class="form-control" placeholder="例：田中あさひ">
					</div>
					<div class="col-sm">
						<label for="tel" class="form-label">電話番号</label>
						<input type="text" th:field="*{tel}" class="form-control" placeholder="例：030-1234-5678"></input>
					</div>
				</div>
				<div class="col-sm-2">
					<label for="postNum" class="form-label">郵便番号</label>
					<input type="text" th:field="*{postNum}" class="form-control" placeholder="例：101-1234"></input>
				</div>
				<div class="col-sm">
					<label for="address" class="form-label">住所</label>
					<input type="text" th:field="*{address}" class="form-control"
						placeholder="例：東京都西区椋梨2-1-4 ミルプレス椋梨203号室"></input>
				</div>
				<input type="submit" value="注文確定" class="mt-3">
			</form>
		</div>
	</div>
</body>

</html>